<!doctype html>
<html>
  <head>
  </head>
  <body>

    <svg fill="#000000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
      <!-- based off of https://thenounproject.com/term/n64-controller/197931/ -->
      <g display="none">
        <rect x="0" y="0.015" display="inline" fill="#000000" width="200" height="200"/>
      </g>
      <g>
        <!-- the part people hold -->
        <path id="base" d="M86.179,18.811c1.909-3.579-17.418-5.368-17.418-5.368L67.45,10.46c0,0-4.474-3.46-16.386-3.46h-0.358
            c-11.912,0-16.386,3.46-16.386,3.46l-1.312,2.982c0,0-19.326,1.789-17.418,5.368C4.614,22.389,5.807,49.828,5.807,53.765
            s1.67,20.877,8.112,20.877s10.975-24.695,10.975-24.695s11.214-1.074,12.526,5.965c1.312,7.039,4.439,38.414,13.284,38.414h0.358
            c8.845,0,11.972-31.375,13.284-38.414c1.312-7.039,12.526-5.965,12.526-5.965s4.533,24.695,10.975,24.695
            s8.112-16.94,8.112-20.877S97.155,22.389,86.179,18.811z M22.986,41.925c-5.189,0-9.395-4.206-9.395-9.395
            s4.206-9.395,9.395-9.395s9.395,4.206,9.395,9.395S28.175,41.925,22.986,41.925z M50.885,30.365c2.332,0,4.223,1.891,4.223,4.223
            c0,2.332-1.891,4.223-4.223,4.223s-4.223-1.891-4.223-4.223C46.662,32.256,48.552,30.365,50.885,30.365z M50.885,63.953
            c-5.742,0-10.396-4.655-10.396-10.396S45.143,43.16,50.885,43.16s10.396,4.655,10.396,10.396S56.626,63.953,50.885,63.953z
            M68.528,37.988c-1.977,0-3.579-1.602-3.579-3.579c0-1.977,1.602-3.579,3.579-3.579s3.579,1.602,3.579,3.579
            C72.107,36.385,70.505,37.988,68.528,37.988z M75.284,44.743c-1.977,0-3.579-1.602-3.579-3.579c0-1.977,1.602-3.579,3.579-3.579
            c1.977,0,3.579,1.602,3.579,3.579C78.863,43.141,77.26,44.743,75.284,44.743z M86.638,32.204l-0.028,0.049
            c-0.597,1.057-1.484,1.908-2.564,2.462L84,34.738c-0.079,1.461-1.285,2.623-2.766,2.623c-1.481,0-2.687-1.162-2.766-2.623
            l-0.046-0.024c-1.08-0.554-1.967-1.405-2.564-2.462l-0.028-0.049c-1.41-0.131-2.514-1.316-2.514-2.761
            c0-1.361,0.981-2.491,2.275-2.727l0.024-0.053c0.584-1.281,1.598-2.333,2.856-2.964l0.065-0.033
            c0.286-1.227,1.384-2.142,2.699-2.142s2.412,0.915,2.699,2.142l0.065,0.033c1.258,0.631,2.272,1.684,2.856,2.964l0.024,0.053
            c1.293,0.235,2.275,1.365,2.275,2.727C89.152,30.887,88.048,32.073,86.638,32.204z"/>
        <g>
          <!-- D-Pad -->
          <polygon points="29.652,30.427 25.134,30.427 25.134,25.909 20.749,25.909 20.749,30.427 16.231,30.427 16.231,34.811 20.749,34.811 20.749,39.33 25.134,39.33 25.134,34.811 29.652,34.811"/>
          <rect id="axis-d-y-down" x="20.749" y="34.811" width="4.5" height="4.5"/>
          <rect id="axis-d-y-up" x="20.749" y="25.909" width="4.5" height="4.5"/>
          <rect id="axis-d-x-left" x="16.231" y="30.427" width="4.5" height="4.5"/>
          <rect id="axis-d-x-right" x="25.134" y="30.427" width="4.5" height="4.5"/>
        </g>
        <circle id="joystick" cx="50.885" cy="53.556" r="5.207"/>
        <circle id="key-start" cx="50.885" cy="34.588" r="3.417"/>
        <circle id="key-b" cx="68.5" cy="34.5" r="3"/>
        <circle id="key-a" cx="75.3" cy="41.2" r="3"/>
        <g>
          <!-- c buttons -->
          <path d="M83.515,29.443c0-1.579,1.284-2.863,2.863-2.863c0.077,0,0.157,0.004,0.243,0.012c-0.55-1.125-1.446-2.058-2.548-2.652
              c0.016,0.121,0.023,0.241,0.023,0.358c0,1.579-1.284,2.863-2.863,2.863c-1.579,0-2.863-1.284-2.863-2.863
              c0-0.117,0.008-0.237,0.023-0.358c-1.102,0.594-1.998,1.527-2.548,2.652c0.087-0.008,0.166-0.012,0.243-0.012
              c1.579,0,2.863,1.284,2.863,2.863c0,1.577-1.281,2.86-2.857,2.863c0.553,0.919,1.335,1.668,2.277,2.18
              c0.054-1.532,1.317-2.762,2.861-2.762c1.545,0,2.808,1.23,2.861,2.762c0.942-0.512,1.724-1.262,2.277-2.18
              C84.796,32.303,83.515,31.02,83.515,29.443z"/>
          <circle id="key-c-up" cx="81.25" cy="24.3" r="2.35"></circle>
          <circle id="key-c-down" cx="81.25" cy="34.6" r="2.35"></circle>
          <circle id="key-c-left" cx="76.13" cy="29.5" r="2.35"></circle>
          <circle id="key-c-right" cx="86.4" cy="29.5" r="2.35"></circle>
        </g>
      </g>
    </svg>


    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io();
      socket.on('connect', () => {
        const elem = document.getElementById('base');
        elem.style.fill = 'black';
      });

      socket.on('disconnect', () => {
        const elem = document.getElementById('base');
        elem.style.fill = 'grey';
      });

      var keys = {
        start: 'red',
        a: 'blue',
        b: 'green',
        'c-up': 'orange',
        'c-down': 'orange',
        'c-left': 'orange',
        'c-right': 'orange',
      };
      Object.keys(keys).forEach(name => {
        const color = keys[name];
        const elem = document.getElementById('key-'+name);
        socket.on('key', (id, value) => {
          if (id !== name) return;
          elem.style.fill = value === 1 ? color : 'grey';
        });
      });

      var joystick = document.getElementById('joystick');
      socket.on('axis', (id, value) => {
        if (id === 'x') {
          joystick.setAttribute('cx', 46 + 9.8 * (value / 255));
        }
        if (id === 'y') {
          joystick.setAttribute('cy', 48.6 + 9.8 * (value / 255));
        }
      });

      var axisDYDown = document.getElementById('axis-d-y-down');
      var axisDYUp = document.getElementById('axis-d-y-up');
      var axisDXLeft = document.getElementById('axis-d-x-left');
      var axisDXRight = document.getElementById('axis-d-x-right');
      socket.on('axis', (id, value) => {
        if (id === 'd-y') {
          if (value === 0) {
            // up
            axisDYDown.style.fill = 'grey';
            axisDYUp.style.fill = 'purple';
          } else if (value === 255) {
            // down
            axisDYDown.style.fill = 'purple';
            axisDYUp.style.fill = 'grey';
          } else {
            axisDYDown.style.fill = 'grey';
            axisDYUp.style.fill = 'grey';
          }
        }
        if (id === 'd-x') {
          if (value === 0) {
            // left
            axisDXLeft.style.fill = 'purple';
            axisDXRight.style.fill = 'grey';
          } else if (value === 255) {
            // right
            axisDXLeft.style.fill = 'grey';
            axisDXRight.style.fill = 'purple';
          } else {
            axisDXLeft.style.fill = 'grey';
            axisDXRight.style.fill = 'grey';
          }
        }
      });
    </script>
  </body>
</html>
